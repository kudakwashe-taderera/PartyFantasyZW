{% extends "base.html" %}
{% load static %}
{% block title %}Party Boxes Â· Party Fantasy ZW{% endblock %}
{% block content %}
<section class="py-10 sm:py-14">
    <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-4 mb-8">
        <div>
            <h1 class="font-display text-2xl sm:text-3xl font-bold text-neutral-900 tracking-tight mb-1">Party boxes</h1>
            <p class="text-neutral-600 text-sm">All prices in USD. Delivery across Zimbabwe.</p>
        </div>
        <form method="get" action="{% url 'product_list' %}" class="flex gap-2 w-full sm:w-auto sm:min-w-[260px]">
            <input type="hidden" name="category" value="{{ current_category }}">
            <input type="search" name="q" value="{{ current_query }}" placeholder="Search..." class="flex-1 sm:flex-none w-full sm:w-48 px-4 py-2.5 rounded-xl border border-neutral-200 text-neutral-900 placeholder-neutral-400 focus:outline-none focus:ring-2 focus:ring-rose-500/30 focus:border-rose-500 text-sm">
            <button type="submit" class="px-4 py-2.5 rounded-xl bg-neutral-100 text-neutral-700 text-sm font-medium hover:bg-neutral-200 transition-colors shrink-0">Search</button>
        </form>
    </div>

    <nav class="flex flex-wrap gap-2 mb-8" aria-label="Categories">
        <a href="{% url 'product_list' %}?q={{ current_query|urlencode }}" class="px-4 py-2 rounded-xl text-sm font-medium transition-colors {% if not current_category %}bg-rose-500 text-white{% else %}bg-white border border-neutral-200 text-neutral-600 hover:bg-neutral-50 hover:border-neutral-300{% endif %}">All</a>
        {% for cat in categories %}
        <a href="{% url 'product_list' %}?q={{ current_query|urlencode }}&category={{ cat.slug }}" class="px-4 py-2 rounded-xl text-sm font-medium transition-colors {% if cat.slug == current_category %}bg-rose-500 text-white{% else %}bg-white border border-neutral-200 text-neutral-600 hover:bg-neutral-50 hover:border-neutral-300{% endif %}">{{ cat.name }}</a>
        {% endfor %}
    </nav>

    {% if products_list %}
    <p class="text-sm text-neutral-500 mb-6">{{ products_list|length }} product{{ products_list|length|pluralize }}</p>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for product in products_list %}
        <article class="flex flex-col bg-white rounded-2xl border border-neutral-200 overflow-hidden shadow-[0_1px_3px_rgba(0,0,0,0.06)] hover:shadow-[0_4px_14px_rgba(0,0,0,0.08)] hover:border-neutral-300/80 transition-all duration-200">
            {% include "includes/zim_stripe.html" %}
            <a href="{% url 'product_detail' product.slug %}" class="relative aspect-[4/3] bg-neutral-100 overflow-hidden block shrink-0">
                {% if product.image %}
                <img src="{{ product.image.url }}" alt="{{ product.name }}" class="w-full h-full object-cover hover:scale-[1.03] transition-transform duration-300">
                {% else %}
                <img src="{% static 'img/placeholder.jpg' %}" alt="{{ product.name }}" class="w-full h-full object-cover hover:scale-[1.03] transition-transform duration-300">
                {% endif %}
                {% if not current_category and product.category %}
                <span class="absolute top-3 left-3 px-2.5 py-1 rounded-lg bg-white/95 text-xs font-medium text-neutral-600 border border-neutral-200/80 shadow-sm">{{ product.category.name }}</span>
                {% endif %}
            </a>
            <div class="p-5 flex flex-col flex-1 min-h-0">
                <a href="{% url 'product_detail' product.slug %}" class="font-semibold text-neutral-900 mb-1 block hover:text-rose-600 transition-colors line-clamp-2">{{ product.name }}</a>
                <p class="text-lg font-bold text-neutral-900 mt-auto pt-3">${{ product.price }}</p>
                <form method="post" action="{% url 'add_to_cart' product.id %}" class="mt-3 flex items-center gap-2">
                    {% csrf_token %}
                    <input type="number" name="qty" value="1" min="1" max="99" class="w-14 px-2 py-2 rounded-xl border border-neutral-200 text-neutral-900 text-sm focus:outline-none focus:ring-2 focus:ring-rose-500/30 focus:border-rose-500" aria-label="Quantity">
                    <button type="submit" class="flex-1 inline-flex items-center justify-center px-4 py-2.5 rounded-xl text-sm font-medium text-white bg-rose-500 hover:bg-rose-600 transition-colors">Add to cart</button>
                </form>
            </div>
        </article>
        {% endfor %}
    </div>
    {% else %}
    <div class="rounded-2xl border border-neutral-200 bg-neutral-50/50 p-12 text-center">
        <p class="text-neutral-600 font-medium mb-1">No products found</p>
        <p class="text-sm text-neutral-500 mb-6">Try a different search or category.</p>
        <a href="{% url 'product_list' %}" class="inline-flex items-center justify-center px-5 py-2.5 rounded-xl font-medium text-rose-600 hover:bg-rose-50 transition-colors">View all</a>
    </div>
    {% endif %}
</section>
{% endblock %}
